<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>jackdaw.client documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Jackdaw</span> <span class="project-version">0.4.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>jackdaw</span></div></div></li><li class="depth-2 branch"><a href="jackdaw.admin.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>admin</span></div></a></li><li class="depth-2 current"><a href="jackdaw.client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>client</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.client.log.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>log</span></div></a></li><li class="depth-3"><a href="jackdaw.client.partitioning.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>partitioning</span></div></a></li><li class="depth-2 branch"><a href="jackdaw.data.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>data</span></div></a></li><li class="depth-2"><a href="jackdaw.serdes.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>serdes</span></div></a></li><li class="depth-3"><a href="jackdaw.serdes.avro.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>avro</span></div></a></li><li class="depth-4"><a href="jackdaw.serdes.avro.schema-registry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>schema-registry</span></div></a></li><li class="depth-3"><a href="jackdaw.serdes.edn.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>edn</span></div></a></li><li class="depth-4"><a href="jackdaw.serdes.edn.nippy.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>nippy</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.serdes.fn.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>fn</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.serdes.fn-impl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fn-impl</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.serdes.json.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>json</span></div></a></li><li class="depth-3"><a href="jackdaw.serdes.uuid.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>uuid</span></div></a></li><li class="depth-2 branch"><a href="jackdaw.specs.html"><div class="inner"><span class="tree" style="top: -269px;"><span class="top" style="height: 278px;"></span><span class="bottom"></span></span><span>specs</span></div></a></li><li class="depth-2"><a href="jackdaw.streams.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>streams</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.streams.configurable.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>configurable</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.streams.configured.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>configured</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.streams.extras.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>extras</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.streams.interop.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interop</span></div></a></li><li class="depth-3"><a href="jackdaw.streams.lambdas.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lambdas</span></div></a></li><li class="depth-4"><a href="jackdaw.streams.lambdas.specs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>specs</span></div></a></li><li class="depth-3 branch"><a href="jackdaw.streams.protocols.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>protocols</span></div></a></li><li class="depth-3"><a href="jackdaw.streams.specs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>specs</span></div></a></li><li class="depth-1"><a href="user.html"><div class="inner"><span class="tree" style="top: -765px;"><span class="top" style="height: 774px;"></span><span class="bottom"></span></span><span>user</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="jackdaw.client.html#var-assign"><div class="inner"><span>assign</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-assign-all"><div class="inner"><span>assign-all</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-assignment"><div class="inner"><span>assignment</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-callback"><div class="inner"><span>callback</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-consumer"><div class="inner"><span>consumer</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-num-partitions"><div class="inner"><span>num-partitions</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-offsets-for-times"><div class="inner"><span>offsets-for-times</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-partitions-for"><div class="inner"><span>partitions-for</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-poll"><div class="inner"><span>poll</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-position"><div class="inner"><span>position</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-position-all"><div class="inner"><span>position-all</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-produce.21"><div class="inner"><span>produce!</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-producer"><div class="inner"><span>producer</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-seek"><div class="inner"><span>seek</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-seek-to-beginning-eager"><div class="inner"><span>seek-to-beginning-eager</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-seek-to-end-eager"><div class="inner"><span>seek-to-end-eager</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-seek-to-timestamp"><div class="inner"><span>seek-to-timestamp</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-send.21"><div class="inner"><span>send!</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-subscribe"><div class="inner"><span>subscribe</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-subscribed-consumer"><div class="inner"><span>subscribed-consumer</span></div></a></li><li class="depth-1"><a href="jackdaw.client.html#var-subscription"><div class="inner"><span>subscription</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">jackdaw.client</h1><div class="doc"><pre class="plaintext">Clojure wrapper to Kafka's consumer and producer APIs.

The consumers and producers are the basis for streams, and many
other use cases. They can be used to send messages directly to, or
read messages from topics. There are also some facilities for
polling, and transactions.

See `jackdaw.client.*` for some add-ons atop this API.
</pre></div><div class="public anchor" id="var-assign"><h3>assign</h3><div class="usage"><code>(assign consumer &amp; topic-partitions)</code></div><div class="doc"><pre class="plaintext">Assign a consumer to specific partitions for specific topics. Returns the consumer.
</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L294">view source</a></div></div><div class="public anchor" id="var-assign-all"><h3>assign-all</h3><div class="usage"><code>(assign-all consumer topics)</code></div><div class="doc"><pre class="plaintext">Assigns all of the partitions for all of the given topics to the consumer
</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L300">view source</a></div></div><div class="public anchor" id="var-assignment"><h3>assignment</h3><div class="usage"><code>(assignment consumer)</code></div><div class="doc"><pre class="plaintext">Return the assigned topics and partitions of a consumer.
</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L122">view source</a></div></div><div class="public anchor" id="var-callback"><h3>callback</h3><div class="usage"><code>(callback on-completion)</code></div><div class="doc"><pre class="plaintext">Return a kafka `Callback` function out of a clojure `fn`.

The fn must be of 2-arity, being `[record-metadata?, ex?]` where the
record-metadata may be the datafied metadata for the produced
record, and the ex may be an exception encountered while producing
the record.

Callbacks are `void`, so the return value is ignored.</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L37">view source</a></div></div><div class="public anchor" id="var-consumer"><h3>consumer</h3><div class="usage"><code>(consumer config)</code><code>(consumer config {:keys [key-serde value-serde], :as t})</code></div><div class="doc"><pre class="plaintext">Return a consumer with the supplied properties and optional Serdes.
</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L91">view source</a></div></div><div class="public anchor" id="var-num-partitions"><h3>num-partitions</h3><div class="usage"><code>(num-partitions producer-or-consumer topic)</code></div><div class="doc"><pre class="plaintext">Given a producer or consumer and a topic, return the number of
partitions for that topic.

Note that partitions are 0-indexed, so a number of partitions 1
means that only partition 0 exists.</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L173">view source</a></div></div><div class="public anchor" id="var-offsets-for-times"><h3>offsets-for-times</h3><div class="usage"><code>(offsets-for-times consumer partition-timestamps)</code></div><div class="doc"><pre class="plaintext">Given a subscribed consumer and a mapping of topic-partition or
`TopicPartition` records to timestamps, return a mapping from
topic-partition descriptors to the offset into each partition of the
FIRST record whose timestamp is equal to or greater than the given
timestamp.

Timestamps are longs to MS precision in UTC.</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L246">view source</a></div></div><div class="public anchor" id="var-partitions-for"><h3>partitions-for</h3><div class="usage"><code>(partitions-for producer-or-consumer {:keys [topic-name]})</code></div><div class="doc"><pre class="plaintext">Given a producer or consumer and a Jackdaw topic descriptor, return
metadata about the partitions assigned to the given consumer or
producer.</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L157">view source</a></div></div><div class="public anchor" id="var-poll"><h3>poll</h3><div class="usage"><code>(poll consumer timeout)</code></div><div class="doc"><pre class="plaintext">Polls kafka for new messages, returning a potentially empty sequence
of datafied messages.</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L182">view source</a></div></div><div class="public anchor" id="var-position"><h3>position</h3><div class="usage"><code>(position consumer topic-partition)</code></div><div class="doc"><pre class="plaintext">Get the offset of the next record that will be fetched.

Accepts either a `TopicPartition` record, or a datafied
`TopicPartition` as generated by the rest of the Jackdaw API.</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L191">view source</a></div></div><div class="public anchor" id="var-position-all"><h3>position-all</h3><div class="usage"><code>(position-all consumer)</code></div><div class="doc"><pre class="plaintext">Call position on every assigned partition, producing a map from
partition information to the consumer's offset into that partition.</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L199">view source</a></div></div><div class="public anchor" id="var-produce.21"><h3>produce!</h3><div class="usage"><code>(produce! producer topic value)</code><code>(produce! producer topic key value)</code><code>(produce! producer topic partition key value)</code><code>(produce! producer topic partition timestamp key value)</code><code>(produce! producer topic partition timestamp key value headers)</code></div><div class="doc"><pre class="plaintext">Helper wrapping `#'send!`.

Builds and sends a `ProducerRecord` so you don't have to. Returns
a future which will produce datafied record metadata when forced.</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L68">view source</a></div></div><div class="public anchor" id="var-producer"><h3>producer</h3><div class="usage"><code>(producer config)</code><code>(producer config {:keys [key-serde value-serde]})</code></div><div class="doc"><pre class="plaintext">Return a producer with the supplied properties and optional Serdes.
</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L28">view source</a></div></div><div class="public anchor" id="var-seek"><h3>seek</h3><div class="usage"><code>(seek consumer topic-partition offset)</code></div><div class="doc"><pre class="plaintext">Seek the consumer to the specified offset on the specified partition.

Accepts either a `TopicPartition` instance or a datafied
`TopicPartition` as produced by the rest of the Jackdaw API.

Returns the consumer for convenience with `-&gt;`, `doto` etc.</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L207">view source</a></div></div><div class="public anchor" id="var-seek-to-beginning-eager"><h3>seek-to-beginning-eager</h3><div class="usage"><code>(seek-to-beginning-eager consumer)</code><code>(seek-to-beginning-eager consumer topic-partitions)</code></div><div class="doc"><pre class="plaintext">Seek to the first offset for the given topic/partitions and force positioning.

When no partitions are passed, seek on all assigned
topic-partitions.</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L232">view source</a></div></div><div class="public anchor" id="var-seek-to-end-eager"><h3>seek-to-end-eager</h3><div class="usage"><code>(seek-to-end-eager consumer)</code><code>(seek-to-end-eager consumer topic-partitions)</code></div><div class="doc"><pre class="plaintext">Seek to the last offset for all assigned partitions, and force positioning.

When no partitions are passed, seek on all assigned partitions.

Returns the consumer.</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L218">view source</a></div></div><div class="public anchor" id="var-seek-to-timestamp"><h3>seek-to-timestamp</h3><div class="usage"><code>(seek-to-timestamp consumer timestamp topics)</code></div><div class="doc"><pre class="plaintext">Given an timestamp in epoch MS, a subscribed consumer and a seq of
Jackdaw topics, seek all partitions of the selected topics to the
offsets reported by Kafka to correlate with the given timestamp.

After seeking, the first message read from each partition will be
the EARLIEST message whose timestamp is greater than or equal to the
timestamp sought.

Returns the consumer for convenience with `-&gt;`, `doto` etc.</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L262">view source</a></div></div><div class="public anchor" id="var-send.21"><h3>send!</h3><div class="usage"><code>(send! producer record)</code><code>(send! producer record callback-fn)</code></div><div class="doc"><pre class="plaintext">Asynchronously sends a record to a topic, returning a `Future`
which will produce a data structure describing the metadata of the
produced record when forced.

A 2-arity callback function may be provided. It will be invoked with
either [RecordMetdata, nil] or [nil, Exception] respectively if the
record was sent or if an exception was encountered.</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L51">view source</a></div></div><div class="public anchor" id="var-subscribe"><h3>subscribe</h3><div class="usage"><code>(subscribe consumer topic-configs)</code></div><div class="doc"><pre class="plaintext">Subscribe a consumer to the specified topics.

Returns the consumer.</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L127">view source</a></div></div><div class="public anchor" id="var-subscribed-consumer"><h3>subscribed-consumer</h3><div class="usage"><code>(subscribed-consumer config topic-configs)</code></div><div class="doc"><pre class="plaintext">Given a broker configuration and topics, returns a consumer that is
subscribed to all of the given topic descriptors.

WARNING: All topics subscribed to by a single consumer must share a
single pair of key and value serde instances. The serdes of the
first requested topic are used, and all other topics are expected to
be able to use same serdes.</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L141">view source</a></div></div><div class="public anchor" id="var-subscription"><h3>subscription</h3><div class="usage"><code>(subscription consumer)</code></div><div class="doc"><pre class="plaintext">Return the subscription(s) of a consumer as a collection of topics.

Subscriptions are a set of strings, being the names of topics which
are subscribed to.</pre></div><div class="src-link"><a href="http://github.com/fundingcircle/jackdaw/blob/0.4.0-SNAPSHOT/src/jackdaw/client.clj#L114">view source</a></div></div></div></body></html>